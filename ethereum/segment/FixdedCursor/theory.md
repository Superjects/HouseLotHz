这里只讨论房源数量大于参摇人数时，选出入围人数的情况。<br>
当房源数量N大于参摇人数M，摇号可以简化为平均每L个人（L=M/N，L>1，可以是整数，也可以是浮点数）可以竞争1套房源的问题。<br>
本方案将参摇人数M按登记编号排列，并以L作为分段的长度，对整个排列进行分段。然后我们保证每个分段里产生一个入围者。<br>
分段内部的序号从0开始，从分段里随机产生一个入围者，实际就是根据L产生一个介于0和L-1之间的随机数的问题。<br>
为了提高效率、简化计算、节约资源消耗，各个分段共用同一个随机数，即每个分段中的入围者位置相同。<br>
因为L在摇号前就已确定，如此，我们把摇号归结为产生一个确定边界的随机数的问题。<br>
当L是一个整数时，我们只需要产生一个范围在[0,L]的随机正整数；当L是一个定长浮点数时，我们分别对整数部分和小数部分各产生一个随机数，两者结合即最终的随机数。<br>
根据目前杭州的情况，浮点数后面取4位小数足以，计算中遇到需割舍时采用四舍五入。<br>
<br>
随机数如何产生：<br>
我们通过以太坊构建智能合约，每个ERC20账户都可以在指定的条件下（指定时间、限定人数），通过调用合约方法发送一个[1,9]范围的自然数，每个账户仅能发送一次，合约对收到的自然数按收到的顺序进行排列，组成一个越来越大的大数字，当发送条件截止时，利用这个大数字用求余法得到随机数。<br>
<br>
打个比方：<br>
假如有35418户参摇415套房源，参摇户数按编号排序（序号从0开始），分为415组，则每组85.3446户，然后我们通过智能合约得到了大数字782183458。接着我们对85取得随机数28，对3446取得随机数40，则最终随机数就是28.004，则第J组（J从1开始）的入围者总序号为<br>
28.004+85.3446*（J-1）<br>
比如第4组的入围者的总序号是284<br>
<br>
风险因素分析：<br>
如果某些人想操纵结果，就必须保证智能合约得到的大数字满足特定条件，我们设置在发送截止之前，每个人都无法知道别人发送的是什么数字，并且汇总的大数字也仅在发送截止之后才能查看，这样在发送截止之前任何人都无法有方向性地改变最终结果。其结果就是，所有参与发送的人都改变了结果，但同时都无法预测改变的方向，从而保证了结果的随机性。<br>
作弊似乎只有一种可能，即所有的发送者都串谋起来，并保证非串谋者无法参与发送，由于发送者是限定人数的，串谋着必须保证自己的网络等因素好于所有的非串谋者，这应该是很难做到的。
另外，即使串谋者真的能做到排斥非串谋者，由于随机数位置在分组里是统一的，串谋者还需要保证他们能分散到分组里的特定位置，在此之前又必须先确定分组的边界，而分组的边界又是报名人数决定的，因此串谋者需要做到：全部报名结束才开始分配编号，并把串谋者编号分散指定位置。目前杭州市的编号是在报名过程中产生，所以可以排除此风险。<br>